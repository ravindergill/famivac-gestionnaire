<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head></h:head>

    <h:body>

        <ui:composition>
            <h:form styleClass="form-horizontal" role="form">
                <div class="form-group col-md-12">
                    <p:dataTable
                        id="datatable_chambre"
                        value="#{familleDetailsBean.membres}"
                        var="membre"
                        selectionMode="single" 
                        selection="#{familleDetailsBean.selectedMembre}" 
                        rowKey="#{membre.id}">
                        <p:ajax event="rowSelect" listener="#{familleDetailsBean.selectMembre()}" update="@form" />

                        <p:column headerText="Prénom Nom">
                            <h:outputText value="#{membre.prenom} #{membre.nom}"></h:outputText>
                        </p:column>

                        <p:column headerText="Référent ?" width="200">
                            <h:outputText value="Oui" rendered="#{membre.referent}"></h:outputText>
                            <h:outputText value="Non" rendered="#{not membre.referent}"></h:outputText>
                        </p:column>

                        <p:column width="120">
                            <p:commandButton 
                                styleClass="btn-default"
                                icon="ui-icon-check"
                                process="@this"
                                title="Définir comme référent"
                                disabled="#{membre.referent}"
                                actionListener="#{familleDetailsBean.definirReferent(membre)}"
                                update="@form :form:tabView_famille:panel_membre_referent" />
                            <p:commandButton 
                                styleClass="btn-default"
                                icon="ui-icon-trash"
                                process="@this"
                                title="Supprimer"
                                disabled="#{membre.referent}"
                                actionListener="#{familleDetailsBean.retirerMembre(membre)}"
                                update="@form">
                                <p:confirm 
                                    header="Confirmation" 
                                    message="Êtes vous sûr de vouloir supprimer ce membre ?" 
                                    icon="ui-icon-alert" />
                            </p:commandButton>
                            <p:confirmDialog global="true">
                                <p:commandButton 
                                    value="Oui" 
                                    type="button" 
                                    styleClass="ui-confirmdialog-yes pull-right" 
                                    icon="ui-icon-check" />
                                <p:commandButton 
                                    value="Non" 
                                    type="button" 
                                    styleClass="ui-confirmdialog-no pull-right" 
                                    icon="ui-icon-close" />
                            </p:confirmDialog>
                        </p:column>

                    </p:dataTable>
                    <br/>
                    <p:commandButton 
                        styleClass="btn-default"
                        icon="ui-icon-plus"
                        process="@this"
                        value="Nouveau membre"
                        actionListener="#{familleDetailsBean.initAjouterMembre()}"
                        update="@form" />
                </div>
                <div class="form-group col-md-12">
                    <hr/>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_nom"
                        styleClass="col-sm-3 control-label"
                        value="Nom" />
                    <div class="col-md-8">
                        <p:inputText 
                            styleClass="form-control" 
                            id="form_nom" 
                            required="true"
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.nom}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_nom_naissance"
                        styleClass="col-sm-3 control-label"
                        value="Nom de naissance" />
                    <div class="col-md-8">
                        <p:inputText 
                            id="form_nom_naissance"
                            styleClass="form-control" 
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.nomDeNaissance}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_prenom"
                        styleClass="col-sm-3 control-label"
                        value="Prénom" />
                    <div class="col-md-8">
                        <p:inputText 
                            id="form_prenom"
                            styleClass="form-control" 
                            required="true"
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.prenom}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_sexe"
                        styleClass="col-sm-3 control-label"
                        value="Sexe" />
                    <div class="col-md-8">
                        <p:selectOneMenu 
                            id="form_sexe"
                            required="true"
                            value="#{familleDetailsBean.membreForm.sexe}">
                            <f:selectItem itemLabel="" itemValue="" />
                            <f:selectItem itemLabel="Homme" itemValue="HOMME" />
                            <f:selectItem itemLabel="Femme" itemValue="FEMME" />
                        </p:selectOneMenu>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_date_naissance" 
                        styleClass="col-sm-3 control-label"
                        value="Date de naissance" />
                    <div class="col-md-8">
                        <p:calendar 
                            locale="fr"
                            pattern="dd/MM/yyyy"
                            navigator="true"
                            yearRange="c-100:c+0"
                            id="form_date_naissance" 
                            mask="99/99/9999"
                            required="true"
                            value="#{familleDetailsBean.membreForm.dateNaissance}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_profession"
                        styleClass="col-sm-3 control-label"
                        value="Profession" />
                    <div class="col-md-8">
                        <p:inputText 
                            id="form_profession"
                            styleClass="form-control" 
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.profession}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="input_lien_parente"
                        styleClass="col-sm-3 control-label"
                        value="Lien de parenté" />
                    <div class="col-md-8">
                        <p:inputText 
                            id="input_lien_parente"
                            styleClass="form-control" 
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.lienDeParente}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_commune_naissance" 
                        styleClass="col-sm-3 control-label"
                        value="Commune de naissance" />
                    <div class="col-md-8">
                        <p:autoComplete
                            id="form_commune_naissance"
                            dropdown="true"
                            value="#{familleDetailsBean.membreForm.communeDeNaissance}"
                            converter="#{communeConverter}"
                            cache="true"
                            required="true"
                            forceSelection="true"
                            var="commune"
                            completeMethod="#{familleDetailsBean.completeCommune}"
                            itemLabel="#{commune.label}"
                            itemValue="#{commune}">
                        </p:autoComplete>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_tel1"
                        styleClass="col-sm-3 control-label"
                        value="Téléphone 1" />
                    <div class="col-md-4">
                        <p:inputText 
                            id="form_tel1"
                            styleClass="form-control" 
                            maxlength="10"
                            value="#{familleDetailsBean.membreForm.coordonnees.telephone1}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_tel2"
                        styleClass="col-sm-3 control-label"
                        value="Téléphone 2" />
                    <div class="col-md-4">
                        <p:inputText 
                            id="form_tel2"
                            styleClass="form-control" 
                            maxlength="10"
                            value="#{familleDetailsBean.membreForm.coordonnees.telephone2}"/>
                    </div>
                </div>
                <div class="form-group">
                    <p:outputLabel 
                        for="form_email"
                        styleClass="col-sm-3 control-label"
                        value="Email" />
                    <div class="col-md-8">
                        <p:inputText 
                            id="form_email"
                            styleClass="form-control" 
                            maxlength="255"
                            value="#{familleDetailsBean.membreForm.coordonnees.email}"/>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-11">
                        <p:commandButton 
                            styleClass="btn-primary pull-right"
                            icon="ui-icon-plus"
                            value="Ajouter"
                            rendered="#{empty familleDetailsBean.membreForm.id}"
                            actionListener="#{familleDetailsBean.ajouterMembre()}"
                            update="@form" />
                        <p:commandButton 
                            styleClass="btn-default pull-right"
                            icon="ui-icon-circle-check"
                            value="Sauver"
                            rendered="#{not empty familleDetailsBean.membreForm.id}"
                            actionListener="#{familleDetailsBean.updateMembre()}"
                            update="@form :form:tabView_famille:panel_membre_referent" />
                    </div>
                </div>
            </h:form>

        </ui:composition>
    </h:body>
</html>

